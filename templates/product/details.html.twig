{% extends 'default.html.twig' %}

{% block title %} Products details {% endblock %}

{% block content %}
    {# section with categories should be generated and included in the template using `include` #}
    <section class="section-content bg padding-y-sm">
        <div class="container">
            <div class="row">
                <div class="col-xl-10 col-md-9 col-sm-12">
                    <main class="card">
                        <div class="row no-gutters">
                            <aside class="col-sm-6 border-right">
                                <article class="gallery-wrap">
                                    <div class="img-wrap">
                                        <div><a href="https://via.placeholder.com/600x400" data-fancybox=""><img
                                                        src="https://via.placeholder.com/600x400"
                                                        class="img-fuid"></a>
                                        </div>
                                    </div> <!-- slider-product.// -->
                                    <div class="img-small-wrap">
                                        <div class="item-gallery"><a
                                                    href="{{ asset('assets/main/img/600x400.png') }}"
                                                    data-fancybox=""><img
                                                        src="{{ asset('assets/main/img/600x400.png') }}"></a>
                                        </div>
                                        <div class="item-gallery"><a
                                                    href="{{ asset('assets/main/img/600x400.png') }}"
                                                    data-fancybox=""><img
                                                        src="{{ asset('assets/main/img/600x400.png') }}"></a>
                                        </div>
                                        <div class="item-gallery"><a
                                                    href="{{ asset('assets/main/img/600x400.png') }}"
                                                    data-fancybox=""><img
                                                        src="{{ asset('assets/main/img/600x400.png') }}"></a>
                                        </div>
                                    </div> <!-- slider-nav.// -->
                                </article> <!-- gallery-wrap .end// -->
                            </aside>
                            <aside class="col-sm-6">
                                <article class="card-body">
                                    <!-- short-info-wrap -->
                                    <h3 class="title mb-3">{{ product.name }}</h3>
                                    <h2>{{ product.price }} â‚¬</h2>
                                    <span>one unity</span>

                                    <dl>
                                        <dt>Description:</dt>
                                        <dd><p>{{ product.description }} </p></dd>
                                        <br><b>Category: </b>{{ product.category }}
                                        <br><b>Available amount: </b><p id="avail">{{ product.availableAmount }}</p>
                                    </dl>
                                    <hr>
                                    <a href="{{ path('cart_add', {'productCode':product.code}) }}" class="btn  btn-warning" id="add_cart"> <i class="fa fa-envelope"></i> Add to
                                        Cart
                                    </a>
                                    <!-- short-info-wrap .// -->
                                </article> <!-- card-body.// -->
                            </aside> <!-- col.// -->
                        </div> <!-- row.// -->
                    </main> <!-- card.// -->
                </div> <!-- col // -->

            </div> <!-- row.// -->
        </div><!-- container // -->
    </section>
    <script>
        $(document).on('click', '#add_cart', function(e){
            e.preventDefault();
            fetch("{{ path("cart_add", {'productCode':product.code})}}", {method: 'POST'})
                .then(function(res){ console.log(res.status);
                if(res.status === 400){
                    alert('We dont have so many products');
                }
                else if(res.status === 200){
                    alert('Product added to cart');
                    $('#avail').text({{ product.availableAmount }} - 1);
                }
                })
                .catch(function (){
                    console.log("You died.")
                });
        })
    </script>
{% endblock %}

{% block right_sidebar %}
    <div class="card">
        <div class="card-header">
            Trade Assurance
        </div>
        <div class="card-body small">
            <span>Trading Company</span>
            <hr>
            Transaction Level: Good <br>
            11 Transactions $330,000+
            <hr>
            Response Time 24h <br>
            Response Rate: 94% <br>
            <hr>
            <a href="">Visit pofile</a>
        </div> <!-- card-body.// -->
    </div> <!-- card.// -->
{% endblock %}